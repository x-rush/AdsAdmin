<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.erpdemo.dao.ReturnListGoodsEntityMapper" >
  <resultMap id="BaseResultMap" type="com.erpdemo.entity.ReturnListGoodsEntity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="code" property="code" jdbcType="VARCHAR" />
    <result column="goodsid" property="goodsid" jdbcType="INTEGER" />
    <result column="model" property="model" jdbcType="VARCHAR" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="num" property="num" jdbcType="INTEGER" />
    <result column="price" property="price" jdbcType="REAL" />
    <result column="total" property="total" jdbcType="REAL" />
    <result column="unit" property="unit" jdbcType="VARCHAR" />
    <result column="returnlistid" property="returnlistid" jdbcType="INTEGER" />
    <result column="typeid" property="typeid" jdbcType="INTEGER" />
    <result column="userid" property="userid" jdbcType="INTEGER" />
    <result column="delflag" property="delflag" jdbcType="INTEGER" />
    <result column="addtime" property="addtime" jdbcType="TIMESTAMP" />
    
<!--     <association property="tGoodsType" javaType="com.erpdemo.entity.TGoodsType">
			<id column="t_id" property="id"/>
			<result column="t_name" property="name"/>
	</association>	--> 
  </resultMap>
  
 <!--  <resultMap id="EchartsResultMap" type="com.erpdemo.echarts.DamageListVO" >
    <result column="num" property="num" jdbcType="DOUBLE" />
    <result column="name" property="name" jdbcType="VARCHAR" />
 
  </resultMap> -->
  
  
<!--    <select id="queryForEcharts" resultMap="EchartsResultMap">
		select
			sum(r.num*r.price) as num,
			t.name
		from 
			t_return_list_goods d left join t_goodstype t 
			on r.typeid = t.id
		group by r.typeid
		order by num desc
	</select>
  <select id="queryForEchartsAvg" resultMap="EchartsResultMap">
		select
			sum(r.num*r.price)/sum(r.num) as num,
			t.name as name
		from 
			t_return_list_goods as d LEFT JOIN t_goodstype as t 
			on r.typeid = t.id 
		GROUP BY r.typeid
		ORDER BY num desc 
	</select>-->
  
  <select id="queryList" resultMap="BaseResultMap">
		select
			r.id as id, 
			r.code as code, 
			r.goodsid as goodsid, 
			r.model as model, 
			r.name as name, 
			r.num as num, 
			r.price as price, 
			r.total as total, 
			r.unit as unit, 
			r.returnlistid as returnlistid, 
			r.typeid as typeid, 
			r.delflag as delflag, 
    		r.addtime as addtime, 
    		r.userid as userid,
    		t.id as t_id,
			t.name as t_name
		from 
			t_return_list_goods r left join t_goodstype t 
			on r.typeid = t.id
		<where>
			<if test="name != null and name.trim() != ''">
				and r.name like concat('%',#{name},'%')
			</if>
			
				and r.delflag =0
		</where>
			
		<choose>
			<when test="sidx != null and sidx.trim() != ''">
				order by ${sidx} ${order}
			</when>
			<otherwise>
				order by r.addtime desc
			</otherwise>
		</choose>
		<if test="offset != null and limit != null">
			limit #{offset}, #{limit}
		</if>
	</select>
	
	<select id="queryGoods" resultMap="BaseResultMap">
		select
			<include refid="Base_Column_List" />
		 from t_return_list_goods
		where id = #{id,jdbcType=INTEGER}
	</select>
	 
	<select id="queryTotal" resultType="int">
		select
			count(*)
		from t_return_list_goods
		<where>
			<if test="name != null and name.trim() != ''">
				and name like concat('%',#{name},'%')
			</if>
			and delflag =0
		</where>
	</select>

	<select id="queryObject" resultMap="BaseResultMap">
		select
			<include refid="Base_Column_List" />
		from t_return_list_goods
		where id = #{id,jdbcType=INTEGER}
	</select>
	
	<select id="querySearch" resultMap="BaseResultMap">
		select
			<include refid="Base_Column_List" />
		from t_return_list_goods
		where id = #{id,jdbcType=INTEGER}
	</select>
  
  
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, code, goodsid, model, name, num, price, total, unit, returnlistid, typeid, userid, 
    delflag, addtime
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from t_return_list_goods
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from t_return_list_goods
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.erpdemo.entity.ReturnListGoodsEntity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_return_list_goods (id, code, goodsid, 
      model, name, num, price, 
      total, unit, returnlistid, 
      typeid, userid, delflag, 
      addtime)
    values (#{id,jdbcType=INTEGER}, #{code,jdbcType=VARCHAR}, #{goodsid,jdbcType=INTEGER}, 
      #{model,jdbcType=VARCHAR}, #{name,jdbcType=VARCHAR}, #{num,jdbcType=INTEGER}, #{price,jdbcType=REAL}, 
      #{total,jdbcType=REAL}, #{unit,jdbcType=VARCHAR}, #{returnlistid,jdbcType=INTEGER}, 
      #{typeid,jdbcType=INTEGER}, #{userid,jdbcType=INTEGER}, #{delflag,jdbcType=INTEGER}, 
      #{addtime,jdbcType=TIMESTAMP})
  </insert>
  <insert id="save" parameterType="com.erpdemo.entity.ReturnListGoodsEntity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_return_list_goods
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="code != null" >
        code,
      </if>
      <if test="goodsid != null" >
        goodsid,
      </if>
      <if test="model != null" >
        model,
      </if>
      <if test="name != null" >
        name,
      </if>
      <if test="num != null" >
        num,
      </if>
      <if test="price != null" >
        price,
      </if>
      <if test="total != null" >
        total,
      </if>
      <if test="unit != null" >
        unit,
      </if>
      <if test="returnlistid != null" >
        returnlistid,
      </if>
      <if test="typeid != null" >
        typeid,
      </if>

        delflag,
        
        addtime,
      
      <if test="userid != null" >
        userid,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
 
      <if test="code != null" >
        #{code,jdbcType=VARCHAR},
      </if>
      <if test="goodsid != null" >
        #{goodsid,jdbcType=INTEGER},
      </if>
      <if test="model != null" >
        #{model,jdbcType=VARCHAR},
      </if>
      <if test="name != null" >
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="num != null" >
        #{num,jdbcType=INTEGER},
      </if>
      <if test="price != null" >
        #{price,jdbcType=REAL},
      </if>
      <if test="total != null" >
        #{total,jdbcType=REAL},
      </if>
      <if test="unit != null" >
        #{unit,jdbcType=VARCHAR},
      </if>
      <if test="returnlistid != null" >
        #{returnlistid,jdbcType=INTEGER},
      </if>
      <if test="typeid != null" >
        #{typeid,jdbcType=INTEGER},
      </if>
        0,
     	now(),
      <if test="userid != null" >
        #{userid,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="update" parameterType="com.erpdemo.entity.ReturnListGoodsEntity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_return_list_goods
    <set >
      <if test="code != null" >
        code = #{code,jdbcType=VARCHAR},
      </if>
      <if test="goodsid != null" >
        goodsid = #{goodsid,jdbcType=INTEGER},
      </if>
      <if test="model != null" >
        model = #{model,jdbcType=VARCHAR},
      </if>
      <if test="name != null" >
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="num != null" >
        num = #{num,jdbcType=INTEGER},
      </if>
      <if test="price != null" >
        price = #{price,jdbcType=REAL},
      </if>
      <if test="total != null" >
        total = #{total,jdbcType=REAL},
      </if>
      <if test="unit != null" >
        unit = #{unit,jdbcType=VARCHAR},
      </if>
      <if test="returnlistid != null" >
        returnlistid = #{returnlistid,jdbcType=INTEGER},
      </if>
      <if test="typeid != null" >
        typeid = #{typeid,jdbcType=INTEGER},
      </if>
      <if test="userid != null" >
        userid = #{userid,jdbcType=INTEGER},
      </if>
      <if test="delflag != null" >
        delflag = #{delflag,jdbcType=INTEGER},
      </if>
      <if test="addtime != null" >
        addtime = #{addtime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.erpdemo.entity.ReturnListGoodsEntity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_return_list_goods
    set code = #{code,jdbcType=VARCHAR},
      goodsid = #{goodsid,jdbcType=INTEGER},
      model = #{model,jdbcType=VARCHAR},
      name = #{name,jdbcType=VARCHAR},
      num = #{num,jdbcType=INTEGER},
      price = #{price,jdbcType=REAL},
      total = #{total,jdbcType=REAL},
      unit = #{unit,jdbcType=VARCHAR},
      returnlistid = #{returnlistid,jdbcType=INTEGER},
      typeid = #{typeid,jdbcType=INTEGER},
      userid = #{userid,jdbcType=INTEGER},
      delflag = #{delflag,jdbcType=INTEGER},
      addtime = #{addtime,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=INTEGER}
  </update>
</mapper>